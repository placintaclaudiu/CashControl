@page
@model EnableAuthenticatorModel
@{
    ViewData["Title"] = "Configureati aplicatia de autentificare";
    ViewData["ActivePage"] = ManageNavPages.TwoFactorAuthentication;
}

<partial name="_StatusMessage" for="StatusMessage" />
<h3>@ViewData["Title"]</h3>
<div>
    <p>Pentru a utiliza o aplicatie de autentificare, parcurgeti urmatorii pasi:</p>
    <ol class="list">
        <li>
            <p>
                Descarcati o aplicatie de autentificare cu doi factori precum Microsoft Authenticator pentru
                <a href="https://go.microsoft.com/fwlink/?Linkid=825072">Android</a> si
                <a href="https://go.microsoft.com/fwlink/?Linkid=825073">iOS</a> sau
                Google Authenticator pentru
                <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en">Android</a> si
                <a href="https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8">iOS</a>.
            </p>
        </li>
        <li>
            <p>Scanati codul QR sau introduceti aceasta cheie <kbd>@Model.SharedKey</kbd> in aplicatia dvs. de autentificare cu doi factori.</p>
@*            <div class="alert alert-info">Invata cum sa <a href="https://go.microsoft.com/fwlink/?Linkid=852423">activati generarea codului QR</a>.</div>
*@            <div id="qrCode"></div>
            <div id="qrCodeData" data-url="@Model.AuthenticatorUri"></div>
        </li>
        <li>
            <p>
                Dupa ce ati scanat codul QR sau ati introdus cheia de mai sus, aplicatia de autentificare cu doi factori va va oferi
                un cod unic. Introdu codul in caseta de confirmare de mai jos.
            </p>
            <div class="row">
                <div class="col-md-6">
                    <form id="send-code" method="post">
                        <div class="form-floating">
                            <input asp-for="Input.Code" class="form-control" autocomplete="off" />
                            <label asp-for="Input.Code" class="control-label form-label">Cod de verificare</label>
                            <span asp-validation-for="Input.Code" class="text-danger"></span>
                        </div>
                        <button type="submit" class="w-100 btn btn-lg btn-primary">Verifica</button>
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    </form>
                </div>
            </div>
        </li>
    </ol>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

        <script>
        $(()=>{
            var qrcode = new QRCode(document.getElementById("qrCode"), {
                text: "@Html.Raw(Model.AuthenticatorUri)",
                width: 300,
                height: 300,
                colorDark : "#000000",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });
        })
        </script>
}
